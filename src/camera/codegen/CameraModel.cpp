#include <cmath>
double u(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return cx + fx*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return cy + fy*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dfx(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return (-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dfy(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dfx(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dfy(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return (-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dcx(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 1;
}

double u_dcy(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dcx(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dcy(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 1;
}

double u_dCx(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(-std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))) + fx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2);
}

double u_dCy(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(-r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dCz(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(-r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dCx(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(-r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))) + fy*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2);
}

double v_dCy(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fy*(-std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dCz(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))) + fy*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2);
}

double u_dX(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))) + fx*(-r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2);
}

double u_dY(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dZ(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(-std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dX(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))) + fy*(-r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2);
}

double v_dY(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dZ(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))) + fy*(-std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2);
}

double u_dk1(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dk2(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dk3(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dk4(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dk5(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dk6(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dp1(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dp2(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dk1(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dk2(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dk3(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dp1(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double v_dp2(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return 0;
}

double u_dr1(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(Cx*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cy*(-std::pow(r1, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r1, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cz*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - X*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Y*(-std::pow(r1, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r1, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Z*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(-Cx*(-2*std::pow(r1, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-2*std::pow(r1, 2)*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(-2*std::pow(r1, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-2*std::pow(r1, 2)*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dr2(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(Cx*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::pow(r2, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cy*(-r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cz*(-2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - X*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::pow(r2, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Y*(-r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Z*(-2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(-Cx*(-2*std::pow(r1, 2)*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-2*r1*std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) - Cz*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::pow(r2, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(-2*std::pow(r1, 2)*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-2*r1*std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) + Z*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::pow(r2, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double u_dr3(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fx*(-Cx*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cy*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(std::pow(r1, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Y*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(Cx*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) + Cy*(-r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cz*(-2*std::pow(r3, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r3, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - X*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) - Y*(-r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Z*(-2*std::pow(r3, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r3, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fx*(-Cx*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::pow(r3, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) + X*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::pow(r3, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dr1(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(Cx*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cy*(-std::pow(r1, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r1, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cz*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - X*(-2*std::pow(r1, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Y*(-std::pow(r1, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r1, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Z*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fy*(-Cx*(-2*std::pow(r1, 2)*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-2*r1*std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r1, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r1, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(-2*std::pow(r1, 2)*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r1, 2)*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-2*r1*std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r1, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r1, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dr2(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(Cx*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::pow(r2, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cy*(-r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cz*(-2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - X*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::pow(r2, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Y*(-r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Z*(-2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fy*(-Cx*(-2*r1*std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) - Cy*(-2*std::pow(r2, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(-2*r1*std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r2, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) + Y*(-2*std::pow(r2, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r2*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

double v_dr3(double fx, double fy, double cx, double cy, double Cx, double Cy, double Cz, double r1, double r2, double r3, double k1, double k2, double k3, double p1, double p2, double X, double Y, double Z)
{
 return fy*(-Cx*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) - Cz*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(r1*r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(std::pow(r2, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + Z*(r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))*(Cx*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) + Cy*(-r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Cz*(-2*std::pow(r3, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r3, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - X*(-2*r1*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r1*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0)) - Y*(-r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Z*(-2*std::pow(r3, 3)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r3, 3)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + 2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))), 2) + fy*(-Cx*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::pow(r3, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + X*(-2*r1*r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r1*r2*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::pow(r3, 2)*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-2*std::pow(r2, 2)*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + std::pow(r2, 2)*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(r1*r3*std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) - r1*r3*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) - 2*r2*std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 2) + r2*std::pow(r3, 2)*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::pow(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2), 3.0/2.0) + r2*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(-Cx*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cy*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) - Cz*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))) + X*(r1*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Y*(-r1*std::sin(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))/std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + r2*r3*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))) + Z*(std::pow(r3, 2)*(1 - std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2))))/(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)) + std::cos(std::sqrt(std::pow(r1, 2) + std::pow(r2, 2) + std::pow(r3, 2)))));
}

